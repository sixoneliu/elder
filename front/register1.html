<!DOCTYPE html>
<html>

<head>
    <title>Log in and Sign up</title>
    <!--css-links-->
    <link href="css/logsign.css" rel="stylesheet" type="text/css" media="all" />
    <link href="css/font-awesome.min.css" rel="stylesheet" type="text/css" media="all" />
    <!--//css-links-->
    <!--meta-tags-->
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="EldersCare Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template, 
    Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyErricsson, Motorola web design" />

    <link href="css/bootstrap.css" rel="stylesheet" type="text/css" />
    <!-- Custom Theme files -->
    <link href="css/style.css" rel="stylesheet" type="text/css" />
    <script src="js/jquery-1.11.1.min.js"></script>
    <!--webfonts-->
    <link href="#css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
    <link href="#css?family=Source+Sans+Pro:400,200,300,600,700,900" rel="stylesheet" type="text/css" />
    <!--//webfonts-->
    <link rel="stylesheet" href="css/flexslider.css" type="text/css" media="screen" />
    <script type="text/javascript" src="js/bootstrap.js"></script>
    <script type="text/javascript" src="js/move-top.js"></script>
    <script type="text/javascript" src="js/easing.js"></script>
    <script type="text/javascript">
        jQuery(document).ready(function($) {
            $('.scroll').click(function(event) {
                event.preventDefault()
                $('html,body').animate({
                    scrollTop: $(this.hash).offset().top
                }, 1200)
            })
        })
    </script>
    <script type="text/javascript">
        $(document).ready(function() {
            /*
                var defaults = {
                containerID: 'toTop', // fading element id
                containerHoverID: 'toTopHover', // fading element hover id
                scrollSpeed: 1200,
                easingType: 'linear'
                };
                */
            $().UItoTop({
                easingType: 'easeOutQuart'
            })
        })
    </script>
    <!--light-box-files -->
    <script src="js/modernizr.custom.97074.js"></script>
    <script src="js/jquery.chocolat.js"></script>
    <link rel="stylesheet" href="css/chocolat.css" type="text/css" media="screen" charset="utf-8" />

    <script type="text/javascript" charset="utf-8">
        $(function() {
            $('.g-left a').Chocolat()
        })
    </script>
    <!--light-box-files -->
</head>

<body>
    <!-- header -->

    <!-- header-bottom -->
    <div class="header-bottom">
        <div class="container">
            <div class="logo">
                <h1><a href="index.html">Elders Care</a></h1>
            </div>
            <nav class="navbar navbar-default" role="navigation">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <!--/.navbar-header-->
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
                        <li><a href="index.html">Home</a></li>
                        <li class="active"><a href="register1.html">Register</a></li>
                        <!-- <li><a href="services.html">Services</a></li>-->
                        <li><a href="matching.html">Matching</a></li>

                        <li><a href="personal.html">Personal</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <!--/.navbar-collapse-->
            </nav>
            <div class="search-box">
                <div id="sb-search" class="sb-search">
                    <form>
                        <input class="sb-search-input" placeholder="Enter your search term..." type="search" name="search" id="search" />
                        <input class="sb-search-submit" type="submit" value="" />
                        <span class="sb-icon-search"> </span>
                    </form>
                </div>
            </div>
            <div class="clearfix"></div>

            <!-- search-scripts -->
            <script src="js/classie.js"></script>
            <script src="js/uisearch.js"></script>
            <script>
                new UISearch(document.getElementById('sb-search'))
            </script>
            <!-- //search-scripts -->
        </div>
    </div>
    <!-- /header-bottom -->

    <h1>Log in and sign up</h1>
    <!-- main-section -->
    <div class="head agile">
        <div class="logo">
            <div class="logo1-top wel"></div>
            <div class="logo1-bottom w3layouts">
                <div class="sky-form"></div>
            </div>
        </div>
        <div class="login w3">
            <div class="sap_tabs">
                <div id="horizontalTab" style="display: block; width: 100%; margin: 0px">
                    <ul class="resp-tabs-list">
                        <li class="resp-tab-item"><span>log in</span></li>
                        <li class="resp-tab-item">
                            <label>/</label><span>sign up</span>
                        </li>
                    </ul>
                    <div class="resp-tabs-container">
                        <div class="tab-1 resp-tab-content">
                            <div class="login-top agileinfo">
                                <form action="#" id="login-form">
                                    <input type="email" class="email" data-key="username" placeholder="E-Mail" required /><span><i class="fa fa-envelope ic1" aria-hidden="true"></i></span>
                                    <input type="password" class="password" data-key="password" placeholder="password" required /><span><i class="fa fa-key ic2" aria-hidden="true"></i></span>

                                    <div class="dropup">
                                        <input class="dropdown-toggle" data-key="type" type="type" readonly id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" placeholder="用户类型" required /><span><i
                                                class="fa fa-key ic6" aria-hidden="true"></i></span>
                                        <ul class="dropdown-menu" aria-labelledby="dropdownMenu2">
                                            <li>user</li>
                                            <li data-value="2">nursing staff</li>
                                        </ul>
                                    </div>
                                    <div class="bottom-w3l">
                                        <div class="submit">
                                            <input type="submit" id="send" name="login" value="log in" />
                                        </div>
                                        <div class="login-bottom login-bottom1">
                                            <ul>
                                                <li>
                                                    <p>or</p>
                                                </li>
                                                <li>
                                                    <a href="#" class="link facebook" target="_parent"><span
                                                            class="fa fa-facebook-square"></span></a>
                                                </li>
                                                <li>
                                                    <a href="#" class="link twitter" target="_parent"><span
                                                            class="fa fa-twitter"></span></a>
                                                </li>
                                                <li>
                                                    <a href="#" class="link google-plus" target="_parent"><span
                                                            class="fa fa-google-plus-square"></span></a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="tab-1 resp-tab-content">
                            <div class="login-top agileits">
                                <form action="#" id="register-form">
                                    <input type="text" class="name active" data-key="username" placeholder="Your Name" required /><span><i class="fa fa-user ic3" aria-hidden="true"></i></span>
                                    <!-- <input type="email" class="email" placeholder="E-Mail" required /><span><i
                                            class="fa fa-envelope ic1 ic4" aria-hidden="true"></i></span> -->
                                    <input type="password" data-key="password" class="password" placeholder="Password" required /><span><i class="fa fa-unlock ic4" aria-hidden="true"></i></span>
                                    <div class="dropup">
                                        <input class="dropdown-toggle" data-key="type" type="type" readonly id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" placeholder="用户类型" required /><span><i
                                                class="fa fa-key ic5" aria-hidden="true"></i></span>
                                        <ul class="dropdown-menu" aria-labelledby="dropdownMenu2">
                                            <li>普通用户</li>
                                            <li>护理人员</li>
                                        </ul>
                                    </div>
                                    <div class="bottom-w3l">
                                        <div class="submit sub1">
                                            <input type="submit" name="login" id="register" value="SIGN UP" />
                                        </div>
                                        <div class="login-bottom agile">
                                            <ul>
                                                <li>
                                                    <p>Or login with</p>
                                                </li>
                                                <li>
                                                    <a href="#" class="link facebook" target="_parent"><span
                                                            class="fa fa-facebook-square"></span></a>
                                                </li>
                                                <li>
                                                    <a href="#" class="link twitter" target="_parent"><span
                                                            class="fa fa-twitter"></span></a>
                                                </li>
                                                <li>
                                                    <a href="#" class="link google-plus" target="_parent"><span
                                                            class="fa fa-google-plus-square"></span></a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="clear"></div>
    </div>
    <!-- //main-section -->

    <!--script-->
    <script src="js/jquery.min.js"></script>
    <script src="js/easyResponsiveTabs.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function() {
                $('#horizontalTab').easyResponsiveTabs({
                    type: 'default',
                    width: 'auto',
                    fit: true,
                })
            })
            //用户类型选择
        $(".dropup .dropdown-menu li").on("click", function(e) {
                $(this).parents(".dropup").children("input").val(e.target.innerText)
            })
            //登录
        $('#send').on('click', (e) => {
                e.preventDefault()
                    // $(this).val("登录中...").prop("disabled", true)
                var inputs = $("#login-form input")
                var loginForm = {}
                for (var index = 0; index < inputs.length; index++) {
                    var inputItem = inputs[index];
                    var key = inputItem.dataset.key
                    console.log(999, inputItem.dataset)
                    if (key) {
                        if (!inputItem.value) {
                            var message = ""
                            if (key === 'type') {
                                message = "please select"
                            }
                            if (key === 'username') {
                                message = "please enter user name"
                            }
                            if (key === 'password') {
                                message = "please enter password"
                            }
                            alert(message)
                            return
                        }
                        if (key === 'type') {
                            loginForm[key] = inputItem.value === 'user' ? "1" : "2"
                        } else {
                            loginForm[key] = inputItem.value
                        }
                    }
                }
                $.ajax({
                        type: "post",
                        url: 'http://localhost:8081/api/lr/login.php',
                        data: loginForm,
                        success(res) {
                            res = JSON.parse(res);
                            if (!res.data) {
                                alert(res.message)
                                return
                            }
                            localStorage.setItem("token", res.data.token)
                            localStorage.setItem("type", loginForm.type)
                            console.log(res);
                            if(loginForm.type == 1){
                                if(res.data.name == null){
                                    location.href = 'personal.html'
                                }else{
                                    location.href = 'personaldetail.html'
                                }
                                
                            }else{
                                if(res.data.name == null){
                                    location.href = 'hpersonal.html'
                                }else{
                                    location.href = 'matching.html'
                                }
                                
                            }
                            
                            
                        }
                    })
                    // alert('log in successful！')
                    // 
            })
            //sign up
        $('#register').on('click', (e) => {
            e.preventDefault()
                // $(this).val("log in...").prop("disabled", true)
            var inputs = $("#register-form input")
            var registerForm = {}
            for (var index = 0; index < inputs.length; index++) {
                var inputItem = inputs[index];
                var key = inputItem.dataset.key
                if (key) {
                    if (!inputItem.value) {
                        var message = ""
                        if (key === 'type') {
                            message = "please select"
                        }

                        if (key === 'username') {
                            message = "please enter user name"
                        }
                        if (key === 'password') {
                            message = "please enter password"
                        }
                        alert(message)
                        return
                    }
                    if (key === 'type') {
                        registerForm[key] = inputItem.value === 'user' ? "1" : "2"
                    } else {
                        registerForm[key] = inputItem.value
                    }
                }
            }
            console.log(registerForm)
            $.ajax({
                    type: "post",
                    url: 'http://localhost:8081/api/lr/register.php',
                    data: registerForm,
                    success(res) {
                        console.log(1111111, res);
                        alert(JSON.parse(res).message)
                        location.reload()
                    }
                })
                // 
        })
    </script>
    <!--script-->

    <!-- Footer -->
    <div class="footer" id="contact">
        <div class="container">
            <div class="col-md-4 contact-left">
                <h3>Address</h3>
                <address>
                    College road, cork<br />
                    Cork, T12Y6HP<br />
                    <abbr title="Phone">P :</abbr> (123) 456-7890
                </address>
            </div>
            <div class="col-md-4 ftr-gd">
                <h3>Follow Us</h3>
                <ul class="social">
                    <li>
                        <a href="#"><i></i></a>
                    </li>
                    <li>
                        <a href="#"><i class="facebook"></i></a>
                    </li>
                    <li>
                        <a href="#"><i class="goog"></i></a>
                    </li>
                    <li>
                        <a href="#"><i class="lin"></i></a>
                    </li>
                </ul>
            </div>
            <div class="col-md-4 contact-left">
                <h3>Phone/Fax</h3>
                <p>Phone : +1234567890</p>
                <p>Fax : +1234567890</p>
                <p>
                    Email : <a href="mailto:info@example.com">info@mycompany.com</a>
                </p>
            </div>
            <div class="clearfix"></div>
            <div class="copyright">
                <p>Copyright &copy; 2023. Company name. All rights reserved.</p>
            </div>
        </div>
    </div>
    <!-- Footer -->
</body>

</html>